webpackJsonp([1],{"1CqH":function(t,n){},Flwh:function(t,n){},NHnr:function(t,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=s("7+uW"),a={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{attrs:{id:"app"}},[s("nav",{staticClass:"navbar bg-primary navbar-expand-lg navbar-dark py-2"},[s("div",{staticClass:"navbar-brand mr-4",on:{click:function(n){t.$router.push({name:"main"})}}},[t._v("\n\t\t\t\teTorn!\n\t\t\t")]),t._v(" "),s("a",{staticClass:"nav-link active text-white",on:{click:function(n){t.$router.push({name:"stores"}).href}}},[t._v("Parades")]),t._v(" "),s("a",{staticClass:"nav-link text-white",on:{click:function(n){t.$router.push({name:"test"}).href}}},[t._v("Testing")]),t._v(" "),s("a",{staticClass:"nav-link text-white",on:{click:function(n){t.$router.push("/config")}}},[t._v("Configuració")])]),t._v(" "),s("router-view",{})],1)},staticRenderFns:[]};var r=s("VU/8")({name:"App"},a,!1,function(t){s("sfb/")},null,null).exports,o=s("/ocq"),i={render:function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v("\n  Aloha\n")])},staticRenderFns:[]};var c=s("VU/8")({},i,!1,function(t){s("Flwh")},null,null).exports,u=s("mvHQ"),l=s.n(u),d=s("mtWM"),m=s.n(d),f={host:"http://labs.iam.cat",port:80,routes:{prefix:"/~a16josortmar/eTorn",stores:"/stores",store:"/store",config:"/config"}},v={data:function(){return{name:"",photoFile:null,focused:!1}},methods:{newStore:function(){var t=this,n=new FormData;n.append("name",this.name),n.append("photoStore",this.photoFile);var s=f.host+f.routes.prefix+f.routes.store;m.a.post(s,n).then(function(n){t.$swal(l()(n.data))})},fileListEvent:function(t){this.photoFile=t[0]}}},p={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"card container"},[s("p",{staticClass:"h1 text-center mb-2 mt-3 title"},[t._v("Nova parada")]),t._v(" "),s("form",{on:{submit:function(n){n.preventDefault(),t.newStore()}}},[s("div",{staticClass:"mr-5 ml-5"},[s("md-field",{},[s("label",{staticClass:"text-info"},[t._v("Nom de la parada")]),t._v(" "),s("md-input",{attrs:{type:"text",required:""},model:{value:t.name,callback:function(n){t.name=n},expression:"name"}})],1)],1),t._v(" "),s("div",{staticClass:"mr-5 mt-2 ml-5 text-info"},[s("md-field",[s("label",{staticClass:"text-info"},[t._v("Foto de la parada")]),t._v(" "),s("md-file",{attrs:{accept:"image/*",required:""},on:{"md-change":t.fileListEvent}})],1)],1),t._v(" "),s("input",{staticClass:"btn btn-primary bg-primary border-0 mt-1 py-2 mb-3",attrs:{type:"submit",value:"Crea"}})])])},staticRenderFns:[]};var _={data:function(){return{stores:[],config:f}},components:{NewStoreComponent:s("VU/8")(v,p,!1,function(t){s("OR1Y")},null,null).exports},created:function(){this.downloadStores()},methods:{downloadStores:function(){var t=this,n=f.host+f.routes.prefix+f.routes.stores;m.a.get(n).then(function(n){t.stores=n.data}).catch(function(t){console.log("Fail")})},deleteStore:function(t){var n=this;m.a.delete(f.host+f.routes.prefix+f.routes.store+"/"+t.id).then(function(t){t.data&&(n.$swal("Parada eliminada."),n.downloadStores())})},updateStore:function(t){this.$swal("Aloha")}}},h={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"px-5 py-5"},[s("div",{staticClass:"row mt-3 h-50 mb-5"},[s("new-store-component",{staticClass:"col-md-4 ml-2 h-75"}),t._v(" "),s("div",{staticClass:"col-md-7 ml-2 mr-3 "},[s("p",{staticClass:"title h2 mb-3"},[t._v("Parades")]),t._v(" "),s("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),s("tbody",[t._l(t.stores,function(n){return[s("tr",{key:n.id},[s("td",[t._v(" "+t._s(n.id)+" ")]),t._v(" "),s("td",[t._v(" "+t._s(n.name)+" ")]),t._v(" "),s("td",[s("img",{attrs:{src:t.config.host+t.config.routes.prefix+n.photopath,width:"150px"}})]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-info",on:{click:function(s){t.updateStore(n)}}},[t._v("\n\t\t\t\t\t\t\t\t\tActualitza\n\t\t\t\t\t\t\t\t")]),t._v(" "),s("button",{staticClass:"btn btn-danger",on:{click:function(s){t.deleteStore(n)}}},[t._v("\n\t\t\t\t\t\t\t\t\tElimina\n\t\t\t\t\t\t\t\t")])])])]})],2)])])],1)])},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("thead",[n("tr",[n("th",[this._v("Id")]),this._v(" "),n("th",[this._v("Nom")]),this._v(" "),n("th",[this._v("Foto ")]),this._v(" "),n("th",[this._v("Accions")])])])}]};var T=s("VU/8")(_,h,!1,function(t){s("XSL0")},null,null).exports,b={data:function(){return{params:{MIN_DURATION_BUCKETS:0,HOUR_START_ALL_BUCKETS:0,HOUR_FINAL_ALL_BUCKETS:0}}},created:function(){var t=this,n=f.host+f.routes.prefix+f.routes.config;m.a.get(n).then(function(n){n.data.forEach(function(n){switch(n.key){case"MIN_DURATION_BUCKETS":t.params.MIN_DURATION_BUCKETS=n.value;break;case"HOUR_START_ALL_BUCKETS":t.params.HOUR_START_ALL_BUCKETS=n.value;break;case"HOUR_FINAL_ALL_BUCKETS":t.params.HOUR_FINAL_ALL_BUCKETS=n.value;break;default:console.log("Hi ha una configuració "+n.key+" que no es contempla ")}})})},methods:{submit:function(){var t=this,n=f.host+f.routes.prefix+f.routes.config;m.a.post(n,{data:{params:this.params}}).then(function(n){n.data.done?(console.log(n.data),t.$swal("Configuració actualitzada")):t.$swal("Configuració NO actualitzada")}).catch(function(n){t.$swal("Error: "+n)})}}},C={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"card container w-50 mt-5"},[s("p",{staticClass:"h1 text-center mb-2 mt-3 title"},[t._v("Configuració torns App")]),t._v(" "),s("form",{staticClass:"mt-3",on:{submit:function(n){return n.preventDefault(),t.submit(n)}}},[s("div",{staticClass:"mr-5 row ml-5"},[s("md-field",{staticClass:"col"},[s("label",{staticClass:"text-info"},[t._v("Hora de apertura")]),t._v(" "),s("md-input",{attrs:{type:"number",maxlength:"2",required:""},model:{value:t.params.HOUR_START_ALL_BUCKETS,callback:function(n){t.$set(t.params,"HOUR_START_ALL_BUCKETS",n)},expression:"params.HOUR_START_ALL_BUCKETS"}})],1)],1),t._v(" "),s("div",{staticClass:"mr-5 row ml-5"},[s("md-field",{staticClass:"col "},[s("label",{staticClass:"text-info"},[t._v("Hora de tancament")]),t._v(" "),s("md-input",{attrs:{type:"number",maxlength:"2",required:""},model:{value:t.params.HOUR_FINAL_ALL_BUCKETS,callback:function(n){t.$set(t.params,"HOUR_FINAL_ALL_BUCKETS",n)},expression:"params.HOUR_FINAL_ALL_BUCKETS"}})],1)],1),t._v(" "),s("div",{staticClass:"mr-5 row ml-5"},[s("md-field",{staticClass:"col"},[s("label",{staticClass:"text-info"},[t._v("Duració dels buckets de torns (en minuts)")]),t._v(" "),s("md-input",{attrs:{type:"number",maxlength:"2",required:""},model:{value:t.params.MIN_DURATION_BUCKETS,callback:function(n){t.$set(t.params,"MIN_DURATION_BUCKETS",n)},expression:"params.MIN_DURATION_BUCKETS"}})],1)],1),t._v(" "),s("input",{staticClass:"btn btn-primary bg-warning border-0 mt-4 mb-3",attrs:{type:"submit",value:"APLICA"}})])])},staticRenderFns:[]};var w=s("VU/8")(b,C,!1,function(t){s("eJjO")},null,null).exports,x={props:{store:Object},data:function(){return{urls:f,actualTurn:0,turnInterval:{},availableHours:[],selectedHour:""}},methods:{nextTurn:function(){var t=this,n=f.host+f.routes.prefix+f.routes.store+"/"+this.store.id+"/nextTurn";m.a.post(n).then(function(n){n.data.done?(t.$swal("success"),t.updateActualTurn()):t.$swal(l()(n.data))}).catch(function(t){})},updateActualTurn:function(){var t=this,n=f.host+f.routes.prefix+f.routes.store+"/"+this.store.id+"/actualTurn";m.a.get(n).then(function(n){n.data.error?t.actualTurn={}:t.actualTurn=n.data}).catch(function(t){console.log(t)})},normalTurn:function(){var t=this,n=f.host+f.routes.prefix+f.routes.store+"/"+this.store.id+"/turn";m.a.post(n).then(function(n){t.$swal("Torn normal demanat."+l()(n.data))}).catch(function(n){t.$swal("Failako")})},vipTurn:function(){var t=this,n=f.host+f.routes.prefix+f.routes.store+"/"+this.store.id+"/vipTurn";m.a.post(n).then(function(n){t.$swal("Torn VIP demanat."+l()(n.data))}).catch(function(n){t.$swal("Failako")})},viewTurnsList:function(){this.$emit("turnsList",this.store)}},created:function(){this.updateActualTurn()},computed:{computedActualTurn:function(){switch(this.actualTurn.type){case"VIP":return"V"+("0"+this.actualTurn.number).slice(-2);case"NORMAL":return"T"+("0"+this.actualTurn.number).slice(-2);case"MOBILE":return"M"+("0"+this.actualTurn.number).slice(-2);default:return"NO TURNS"}}}},U={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"store my-2 mx-2"},[s("img",{staticClass:"img-card",attrs:{src:t.urls.host+t.urls.routes.prefix+t.store.photopath}}),t._v(" "),s("h1",{staticClass:"mb-3 mt-2"},[t._v(t._s(t.store.name))]),t._v(" "),s("h4",[t._v("Torn Actual:")]),t._v(" "),s("h3",{staticClass:"mb-1"},[t._v(t._s(t.computedActualTurn))]),t._v(" "),s("div",{staticClass:"mb-3"},[s("button",{staticClass:"btn btn-primary",on:{click:function(n){t.nextTurn()}}},[t._v("Passar torn")])]),t._v(" "),s("h4",[t._v("Demanar torn")]),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"mx-2"},[s("button",{staticClass:"btn btn-primary",on:{click:function(n){t.normalTurn()}}},[t._v("Normal")])]),t._v(" "),s("div",{staticClass:"mx-2"},[s("button",{staticClass:"btn btn-primary",on:{click:function(n){t.vipTurn()}}},[t._v("VIP")])])]),t._v(" "),s("button",{staticClass:"btn btn-primary",on:{click:function(n){t.viewTurnsList()}}},[t._v("Veure llista de torns")])])},staticRenderFns:[]};var A=s("VU/8")(x,U,!1,function(t){s("pX6Z")},null,null).exports,L={props:{store:Object},data:function(){return{normalTurns:[],mobileTurns:[],vipTurns:[]}},methods:{close:function(){this.$emit("closeModal")},downloadTurns:function(){var t=this,n=f.host+f.routes.prefix+f.routes.store+"/"+this.store.id+"/turns";m.a.get(n).then(function(n){n.data.forEach(function(n){switch(n.type){case"NORMAL":t.normalTurns.push(n);break;case"VIP":t.vipTurns.push(n);break;case"BUCKET_QUEUE":t.mobileTurns.push(n)}})}).catch(function(t){console.error(t)})}},beforeMount:function(){this.downloadTurns()}},g={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{attrs:{id:"turns-list-modal-wrapper"}},[s("div",{attrs:{id:"turns-list-modal"}},[s("h1",{staticClass:"mb-5"},[t._v("Torns "+t._s(t.store.name)+" ")]),t._v(" "),s("div",{staticClass:"row mt-2 turns-row"},[s("div",{staticClass:"col-md-4 turn-column"},[s("h3",[t._v("Normal")]),t._v(" "),t._l(t.normalTurns,function(n,e){return[s("p",{key:e},[t._v("T"+t._s(n.number))])]})],2),t._v(" "),s("div",{staticClass:"col-md-4 turn-column"},[s("h3",[t._v("Mòbil")]),t._v(" "),t._l(t.mobileTurns,function(n,e){return[s("p",{key:e},[t._v("M"+t._s(n.number))])]})],2),t._v(" "),s("div",{staticClass:"col-md-4 turn-column"},[s("h3",[t._v("VIP")]),t._v(" "),t._l(t.vipTurns,function(n,e){return[s("p",{key:e},[t._v("V"+t._s(n.number))])]})],2)]),t._v(" "),s("button",{staticClass:"btn btn-primary",on:{click:function(n){t.close()}}},[t._v("Close")])])])},staticRenderFns:[]};var S={components:{TestingStoreComponent:A,TurnsListModal:s("VU/8")(L,g,!1,function(t){s("1CqH")},null,null).exports},data:function(){return{stores:[],showTurnsModal:!1,storeModal:{}}},created:function(){var t=this,n=f.host+f.routes.prefix+f.routes.stores;m.a.get(n).then(function(n){t.stores=n.data}).catch(function(t){console.log(t)})},methods:{showTurnsListModal:function(t){this.storeModal=t,this.showTurnsModal=!0},closeModal:function(){this.showTurnsModal=!1}}},E={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"py-5 px-5 flexxx justify-content-center"},[t.showTurnsModal?s("div",[s("TurnsListModal",{attrs:{store:t.storeModal},on:{closeModal:function(n){t.closeModal()}}})],1):t._e(),t._v(" "),t._l(t.stores,function(n){return[s("TestingStoreComponent",{key:n.name,staticClass:"d-inline",attrs:{store:n},on:{turnsList:t.showTurnsListModal}})]})],2)},staticRenderFns:[]};var R=s("VU/8")(S,E,!1,function(t){s("TDsw")},null,null).exports,k=new o.a({routes:[{path:"/",name:"main",component:c},{path:"/stores",name:"stores",component:T},{path:"/test",name:"test",component:R},{path:"/config",name:"config",component:w}]}),y=s("Lgyv"),N=s.n(y),M=s("oYt9");e.default.use(N.a),e.default.use(M.a),e.default.use(o.a),e.default.config.productionTip=!1,new e.default({el:"#app",router:k,components:{App:r},template:"<App/>"})},OR1Y:function(t,n){},TDsw:function(t,n){},UdIB:function(t,n){},XSL0:function(t,n){},eJjO:function(t,n){},pX6Z:function(t,n){},"sfb/":function(t,n){}},["NHnr"]);
//# sourceMappingURL=app.e019ffc85da3def9fd69.js.map